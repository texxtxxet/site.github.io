<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>æœãƒãƒƒã‚¯ã®ãƒ‰ãƒªãƒ«</title>
  <style>
    :root {
      --bg: #fff8f0;      /* æœãƒãƒƒã‚¯é¢¨èƒŒæ™¯ï¼ˆæ˜ã‚‹ã„ãƒ™ãƒ¼ã‚¸ãƒ¥ï¼‰ */
      --card: #fff3e0;
      --muted: #b88c5a;
      --text: #3b2f2f;
      --accent: #ffb74d;
      --ok: #2ecc71;
      --ng: #ff6b6b;
      --warn: #ff9800;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      background: var(--bg);
      color: var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Hiragino Kaku Gothic ProN", Meiryo, sans-serif;
      line-height: 1.5;
    }
    header { padding: 20px; text-align: center; }
    header h1 { margin: 0 0 6px; font-size: 24px; letter-spacing: .03em; color: var(--accent);}
    header p { margin: 0; color: var(--muted); font-size: 14px; }

    .wrap { max-width: 1100px; margin: 0 auto; padding: 16px; display: grid; gap: 16px; grid-template-columns: 1fr; }
    @media (min-width: 768px) { .wrap { grid-template-columns: 320px 1fr; } }

    .card {
      background: linear-gradient(180deg, rgba(255,255,255,.6), rgba(255,255,255,.3));
      border: 1px solid rgba(200,150,100,.4);
      box-shadow: 0 12px 30px rgba(0,0,0,.15);
      border-radius: 16px;
      overflow: hidden;
    }
    .card h2 { margin: 0; font-size: 16px; padding: 14px 16px; background: rgba(255,183,77,.2); border-bottom: 1px solid rgba(200,150,100,.3); }
    .card .body { padding: 14px; }

    select, button, .pill {
      appearance: none;
      border: 1px solid rgba(200,150,100,.5);
      background: rgba(255,230,200,.4);
      color: var(--text);
      padding: 10px 12px;
      border-radius: 12px;
      font-size: 14px;
    }
    select { width: 100%; color: #000; background: #fff; border: 1px solid #ccc; border-radius: 8px; }
    button { cursor: pointer; transition: transform .05s ease, background .15s ease, border-color .15s; }
    button:hover { transform: translateY(-1px); }
    button:active { transform: translateY(0); }

    .toolbar { display: flex; flex-direction: column; gap: 10px; }
    .btn-row { display: flex; flex-direction: column; gap: 8px; }
    @media (min-width: 520px) { .btn-row { flex-direction: row; flex-wrap: wrap; } }

    .options { display: flex; flex-wrap: wrap; gap: 8px; }
    .pill { user-select: none; cursor: pointer; }
    .pill[disabled] { opacity: .35; cursor: not-allowed; }

    .stack {
      min-height: 400px; display: flex; flex-direction: column; gap: 10px; justify-content: flex-start; align-items: stretch;
      background: repeating-linear-gradient(180deg, rgba(255,235,205,.2) 0 8px, rgba(255,230,200,.15) 8px 16px);
      border: 1px dashed rgba(200,150,100,.5); border-radius: 16px; padding: 16px; position: relative;
    }
    .stack::before, .stack::after { position: absolute; left: 12px; color: var(--muted); font-size: 12px; letter-spacing: .04em; }
    .stack::before { content: "TOP"; top: 8px; }
    .stack::after { content: "BOTTOM"; bottom: 8px; }

    .layer { padding: 10px 12px; border-radius: 12px; border: 1px solid rgba(200,150,100,.5); background: rgba(255,230,200,.4); display: flex; align-items: center; justify-content: space-between; gap: 10px; }
    .layer.ok { border-color: rgba(46,204,113,.6); box-shadow: 0 0 0 2px rgba(46,204,113,.15) inset; }
    .layer.ng { border-color: rgba(255,107,107,.6); box-shadow: 0 0 0 2px rgba(255,107,107,.12) inset; }

    .status { font-size: 14px; padding: 12px; border-radius: 12px; }
    .status.ok { background: rgba(46,204,113,.12); border: 1px solid rgba(46,204,113,.35); }
    .status.ng { background: rgba(255,107,107,.12); border: 1px solid rgba(255,107,107,.35); }
    .status.hint { background: rgba(255,184,107,.12); border: 1px solid rgba(255,184,107,.35); }

    .kbd { padding: 2px 6px; border-radius: 6px; border: 1px solid rgba(255,255,255,.2); font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; background: rgba(255,255,255,.06); font-size: 12px; }

    .flex { display: flex; gap: 8px; align-items: center; }
    .space { height: 6px; }
  </style>
</head>
<body>

<main class="wrap">
  <section class="card">
    <h2>æœãƒãƒƒã‚¯ é¸æŠãƒ»æ“ä½œ</h2>
    <div class="body">
      <div class="toolbar">
        <label>
          <span class="space"></span>
          <select id="burgerSelect" aria-label="ãƒãƒ¼ã‚¬ãƒ¼ã‚’é¸æŠ"></select>
        </label>
        <div class="btn-row">
          <button id="btnCheck">ãƒã‚§ãƒƒã‚¯</button>
          <button id="btnUndo">ä¸€æ‰‹æˆ»ã™</button>
          <button id="btnReset">ãƒªã‚»ãƒƒãƒˆ</button>
        </div>
        <div class="btn-row">
          <button id="btnHint">ãƒ’ãƒ³ãƒˆï¼ˆæ¬¡ã®æ­£è§£ï¼‰</button>
          <button id="btnAuto">è‡ªå‹•é…ç½®</button>
          <button id="btnReveal">æ­£è§£è¡¨ç¤ºï¼éè¡¨ç¤º</button>
        </div>
      </div>
    </div>
  </section>

  <section class="card">
    <h2>é¸æŠè‚¢ï¼ˆã‚¯ãƒªãƒƒã‚¯ã§è¿½åŠ ï¼‰</h2>
    <div class="body">
      <div id="options" class="options" aria-live="polite"></div>
    </div>
  </section>

  <section class="card" style="grid-column: 1 / -1;">
    <h2>ã‚ãªãŸã®ã‚¹ã‚¿ãƒƒã‚¯</h2>
    <div class="body">
      <div id="stack" class="stack" aria-live="polite"></div>
      <div id="status" class="status hint" style="margin-top: 12px;">ãƒãƒ¼ã‚¬ãƒ¼ã‚’é¸ã‚“ã§ã€ä¸Šã‹ã‚‰é †ã«ç½®ã„ã¦ã„ã“ã†ã€‚</div>
    </div>
  </section>
</main>

<script>
const BURGERS = {
  "ãƒ¡ã‚¬ãƒãƒ•ã‚£ãƒ³": [
    "ãƒãƒ•ã‚£ãƒ³ï¼ˆã‚¯ãƒ©ã‚¦ãƒ³ï¼‰",
    "ã‚±ãƒãƒ£ãƒƒãƒ—",
    "ã‚¹ãƒ¢ãƒ¼ã‚¯ãƒ™ãƒ¼ã‚³ãƒ³",
    "ã‚¨ãƒƒã‚°",
    "ã‚½ãƒ¼ã‚»ãƒ¼ã‚¸ãƒ‘ãƒ†ã‚£",
    "ã‚¹ãƒ©ã‚¤ã‚¹ãƒãƒ¼ã‚º",
    "ã‚½ãƒ¼ã‚»ãƒ¼ã‚¸ãƒ‘ãƒ†ã‚£",
    "ãƒãƒ•ã‚£ãƒ³ï¼ˆãƒ’ãƒ¼ãƒ«ï¼‰"
  ],
  "ã‚½ãƒ¼ã‚»ãƒ¼ã‚¸ã‚¨ãƒƒã‚°ãƒãƒ•ã‚£ãƒ³": [
    "ãƒãƒ•ã‚£ãƒ³ï¼ˆã‚¯ãƒ©ã‚¦ãƒ³ï¼‰",
    "ã‚¨ãƒƒã‚°",
    "ã‚½ãƒ¼ã‚»ãƒ¼ã‚¸ãƒ‘ãƒ†ã‚£",
    "ã‚¹ãƒ©ã‚¤ã‚¹ãƒãƒ¼ã‚º",
    "ãƒãƒ•ã‚£ãƒ³ï¼ˆãƒ’ãƒ¼ãƒ«ï¼‰"
  ],
  "ã‚¨ãƒƒã‚°ãƒãƒƒã‚¯ãƒãƒ•ã‚£ãƒ³": [
    "ãƒãƒ•ã‚£ãƒ³ï¼ˆã‚¯ãƒ©ã‚¦ãƒ³ï¼‰",
    "ã‚«ãƒŠãƒ‡ã‚£ã‚¢ãƒ³ãƒ™ãƒ¼ã‚³ãƒ³",
    "ã‚¨ãƒƒã‚°",
    "ã‚¹ãƒ©ã‚¤ã‚¹ãƒãƒ¼ã‚º",
    "ãƒãƒ•ã‚£ãƒ³ï¼ˆãƒ’ãƒ¼ãƒ«ï¼‰"
  ],
  "ãƒã‚­ãƒ³ãƒãƒƒã‚¯ãƒãƒ•ã‚£ãƒ³": [
    "ãƒãƒ•ã‚£ãƒ³ï¼ˆã‚¯ãƒ©ã‚¦ãƒ³ï¼‰",
    "ãƒãƒƒã‚¯ãƒã‚­ãƒ³ãƒ‘ãƒ†ã‚£",
    "ã‚¹ãƒ©ã‚¤ã‚¹ãƒ¬ã‚¿ã‚¹",
    "ã‚¤ã‚¨ãƒ­ãƒ¼ãƒã‚¹ã‚¿ãƒ¼ãƒ‰",
    "ãƒãƒ•ã‚£ãƒ³ï¼ˆãƒ’ãƒ¼ãƒ«ï¼‰"
  ],
  "ã‚½ãƒ¼ã‚»ãƒ¼ã‚¸ãƒãƒ•ã‚£ãƒ³": [
    "ãƒãƒ•ã‚£ãƒ³ï¼ˆã‚¯ãƒ©ã‚¦ãƒ³ï¼‰",
    "ã‚½ãƒ¼ã‚»ãƒ¼ã‚¸ãƒ‘ãƒ†ã‚£",
    "ã‚¹ãƒ©ã‚¤ã‚¹ãƒãƒ¼ã‚º",
    "ãƒãƒ•ã‚£ãƒ³ï¼ˆãƒ’ãƒ¼ãƒ«ï¼‰"
  ],
  "ãƒ•ã‚£ãƒ¬ã‚ªãƒ•ã‚£ãƒƒã‚·ãƒ¥": [
    "ãƒ¬ã‚®ãƒ¥ãƒ©ãƒ¼ãƒãƒ³ã‚ºï¼ˆã‚¯ãƒ©ã‚¦ãƒ³ï¼‰",
    "ã‚¿ãƒ«ã‚¿ãƒ«ã‚½ãƒ¼ã‚¹",
    "ãƒ•ã‚£ãƒƒã‚·ãƒ¥ãƒãƒ¼ã‚·ãƒ§ãƒ³",
    "ãƒãƒ¼ãƒ•ãƒãƒ¼ã‚º",
    "ãƒ¬ã‚®ãƒ¥ãƒ©ãƒ¼ãƒãƒ³ã‚ºï¼ˆãƒ’ãƒ¼ãƒ«ï¼‰"
  ],
  "ãƒ™ãƒ¼ã‚³ãƒ³ã‚¨ãƒƒã‚°ãƒãƒƒã‚¯ã‚µãƒ³ãƒ‰": [
    "ãƒ¬ã‚®ãƒ¥ãƒ©ãƒ¼ãƒãƒ³ã‚ºï¼ˆã‚¯ãƒ©ã‚¦ãƒ³ï¼‰",
    "ã‚¹ãƒ¢ãƒ¼ã‚¯ãƒ™ãƒ¼ã‚³ãƒ³",
    "ã‚¹ãƒ©ã‚¤ã‚¹ãƒãƒ¼ã‚º",
    "ã‚¨ãƒƒã‚°",
    "ãƒ¬ã‚®ãƒ¥ãƒ©ãƒ¼ãƒãƒ³ã‚ºï¼ˆãƒ’ãƒ¼ãƒ«ï¼‰"
  ],
  "ãƒãƒƒã‚¯ã‚°ãƒªãƒ‰ãƒ« ã‚½ãƒ¼ã‚»ãƒ¼ã‚¸ã‚¨ãƒƒã‚°": [
    "ã‚°ãƒªãƒ‰ãƒ«ã‚±ãƒ¼ã‚­ï¼ˆã‚¯ãƒ©ã‚¦ãƒ³ï¼‰",
    "ã‚¨ãƒƒã‚°",
    "ã‚½ãƒ¼ã‚»ãƒ¼ã‚¸ãƒ‘ãƒ†ã‚£",
    "ã‚¹ãƒ©ã‚¤ã‚¹ãƒãƒ¼ã‚º",
    "ã‚°ãƒªãƒ‰ãƒ«ã‚±ãƒ¼ã‚­ï¼ˆãƒ’ãƒ¼ãƒ«ï¼‰"
  ],
  "ãƒãƒƒã‚¯ã‚°ãƒªãƒ‰ãƒ« ãƒ™ãƒ¼ã‚³ãƒ³ã‚¨ãƒƒã‚°": [
    "ã‚°ãƒªãƒ‰ãƒ«ã‚±ãƒ¼ã‚­ï¼ˆã‚¯ãƒ©ã‚¦ãƒ³ï¼‰",
    "ã‚¨ãƒƒã‚°",
    "ã‚¹ãƒ¢ãƒ¼ã‚¯ãƒ™ãƒ¼ã‚³ãƒ³",
    "ã‚¹ãƒ©ã‚¤ã‚¹ãƒãƒ¼ã‚º",
    "ã‚°ãƒªãƒ‰ãƒ«ã‚±ãƒ¼ã‚­ï¼ˆãƒ’ãƒ¼ãƒ«ï¼‰"
  ],
  "ãƒãƒƒã‚¯ã‚°ãƒªãƒ‰ãƒ« ã‚½ãƒ¼ã‚»ãƒ¼ã‚¸": [
    "ã‚°ãƒªãƒ‰ãƒ«ã‚±ãƒ¼ã‚­ï¼ˆã‚¯ãƒ©ã‚¦ãƒ³ï¼‰",
    "ã‚½ãƒ¼ã‚»ãƒ¼ã‚¸ãƒ‘ãƒ†ã‚£",
    "ã‚°ãƒªãƒ‰ãƒ«ã‚±ãƒ¼ã‚­ï¼ˆãƒ’ãƒ¼ãƒ«ï¼‰"
  ]
};


  // ä»¥ä¸‹ã€æ—¢å­˜ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨åŒã˜æ§‹é€ ã‚’åˆ©ç”¨
  const $ = (sel) => document.querySelector(sel);
  const $$ = (sel) => Array.from(document.querySelectorAll(sel));
  const shuffle = (arr) => arr.map(v=>[Math.random(), v]).sort((a,b)=>a[0]-b[0]).map(([,v])=>v);

  let currentKey = Object.keys(BURGERS)[0];
  let target = [...BURGERS[currentKey]];
  let stack = [];
  let reveal = false;

  function initSelect() {
    const sel = $('#burgerSelect');
    sel.innerHTML = Object.keys(BURGERS).map(k => `<option value="${k}">${k}</option>`).join('');
    sel.value = currentKey;
    sel.addEventListener('change', () => {
      currentKey = sel.value;
      loadBurger(currentKey);
    });
  }

  function loadBurger(key) {
    target = [...BURGERS[key]];
    stack = [];
    reveal = false;
    renderOptions();
    renderStack();
    setStatus('ãƒãƒ¼ã‚¬ãƒ¼ã‚’é¸ã‚“ã§ã€ä¸Šã‹ã‚‰é †ã«ç½®ã„ã¦ã„ã“ã†ã€‚', 'hint');
  }

  function renderOptions() {
    const box = $('#options'); box.innerHTML = '';
    const counts = {};
    target.forEach(label => counts[label] = (counts[label] || 0) + 1);
    Object.keys(counts).forEach(label => {
      const maxCount = counts[label];
      const usedCount = stack.filter(v => v === label).length;
      const remaining = maxCount - usedCount;
      for (let i = 0; i < remaining; i++) {
        const btn = document.createElement('button');
        btn.className = 'pill';
        btn.textContent = label;
        btn.addEventListener('click', () => addLayer(label));
        box.appendChild(btn);
      }
    });
  }

  function renderStack(mark = []) {
    const s = $('#stack'); s.innerHTML = '';
    stack.forEach((label, i) => {
      const row = document.createElement('div'); row.className = 'layer';
      if (mark[i] === true) row.classList.add('ok');
      if (mark[i] === false) row.classList.add('ng');
      const left = document.createElement('div'); left.textContent = label;
      const right = document.createElement('div'); right.className = 'flex';
      const idx = document.createElement('small'); idx.textContent = `${i+1}/${target.length}`;
      const del = document.createElement('button'); del.textContent = 'Ã—'; del.addEventListener('click', () => removeAt(i));
      right.append(idx, del); row.append(left, right); s.appendChild(row);
    });
    if (reveal) {
      target.forEach((label, i) => { if (i >= stack.length) {
        const ghost = document.createElement('div'); ghost.className = 'layer'; ghost.style.opacity = .45;
        ghost.innerHTML = `<span>${label}</span><small>${i+1}/${target.length}</small>`;
        s.appendChild(ghost);
      }});
    }
  }

  function addLayer(label) { stack.push(label); renderOptions(); renderStack(); }
  function removeAt(index) { stack.splice(index, 1); renderOptions(); renderStack(); }
  function undo() { stack.pop(); renderOptions(); renderStack(); }
  function resetAll() { loadBurger(currentKey); }

  function check() {
    if (stack.length === 0) { setStatus('ã¾ãšã¯1æšç½®ã„ã¦ã¿ã‚ˆã†ï¼', 'hint'); return; }
    const marks = stack.map((v, i) => v === target[i]);
    renderStack(marks);
    const allPlaced = stack.length === target.length;
    const allCorrect = marks.every(Boolean) && allPlaced;
    if (allCorrect) setStatus('ğŸ‰ æ­£è§£ï¼å®Œç’§ãªé‡ã­æ–¹ï¼', 'ok');
    else if (!allPlaced) { const nextNeed = target[stack.length]; setStatus(`ã¾ã é€”ä¸­ã€‚æ¬¡ã¯ <b>${nextNeed}</b>`, 'hint'); }
    else setStatus(`é †ç•ªé•ã„ãŒã‚ã‚‹ã‚ˆã€‚`, 'ng');
  }

  function hint() {
    const idx = stack.length;
    if (idx >= target.length) { setStatus('å…¨ã¦é…ç½®æ¸ˆã¿ã€‚ãƒã‚§ãƒƒã‚¯ã—ã¦ã­ã€‚', 'hint'); return; }
    const next = target[idx]; highlightOption(next);
    setStatus(`ãƒ’ãƒ³ãƒˆï¼šæ¬¡ã¯ <b>${next}</b>`, 'hint');
  }

  function autoPlaceOne() { const idx = stack.length; if (idx >= target.length) return; addLayer(target[idx]); setStatus(`1æšè‡ªå‹•é…ç½®ï¼š<b>${target[idx]}</b>`, 'hint'); }
  function toggleReveal() { reveal = !reveal; renderStack(); setStatus(reveal ? 'æ­£è§£ã‚¬ã‚¤ãƒ‰ã‚’è¡¨ç¤ºä¸­' : 'æ­£è§£ã‚¬ã‚¤ãƒ‰ã‚’éè¡¨ç¤º', 'hint'); }
  function highlightOption(text) { $$('#options .pill').forEach(el => { el.style.outline = (el.textContent === text) ? '2px solid var(--warn)' : 'none'; });
    setTimeout(() => $$('#options .pill').forEach(el => el.style.outline = 'none'), 1600);
  }

  function setStatus(html, kind='hint') { const box = $('#status'); box.className = `status ${kind}`; box.innerHTML = html; }
  function bind() {
    $('#btnCheck').addEventListener('click', check);
    $('#btnUndo').addEventListener('click', undo);
    $('#btnReset').addEventListener('click', resetAll);
    $('#btnHint').addEventListener('click', hint);
    $('#btnAuto').addEventListener('click', autoPlaceOne);
    $('#btnReveal').addEventListener('click', toggleReveal);
  }

  initSelect(); bind(); loadBurger(currentKey);
</script>
</body>
</html>
