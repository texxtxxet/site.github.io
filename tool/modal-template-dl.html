<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modal HTML Template Downloader</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        #downloadBtn {
            background-color: #4CAF50;
            border: none;
            color: white;
            padding: 15px 32px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 4px 2px;
            cursor: pointer;
        }
        #htmlContent {
            width: 100%;
            height: 300px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>Modal HTML Template Downloader</h1>
    <button id="downloadBtn">ダウンロード</button>
    <textarea id="htmlContent">
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>〇</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
    }
    .container {
      display: flex;
      flex-wrap: wrap;
    }
    .thumbnail {
      width: 240px; /* 統一のサムネイルサイズ */
      height: 140px; /* 統一のサムネイルサイズ */
      margin: 10px;
      margin: 10px;
      cursor: pointer;
      text-align: center;
    }
    /* キャプションのスタイル */
    .caption {
      margin-top: -5px; /* キャプションとサムネイルの間隔を広げる */
      font-size: 14px;
    }
    .thumbnail img {
      width: 100%;
      height: 100%;
      object-fit: cover; /* アスペクト比を保ちつつ全てのサムネイルに画像をフィット */
    }

    .video-thumbnail {
      width: 240px; /* 統一のサムネイルサイズ */
      height: 140px; /* 統一のサムネイルサイズ */
      margin: 10px;
      margin: 10px;
      cursor: pointer;
      text-align: center;
    }

    .video-thumbnail video {
      width: 100%;
      height: 100%;
      object-fit: cover; /* アスペクト比を保ちつつ全てのサムネイルに動画をフィット */
    }

    /* モーダルウィンドウ */
    .modal {
      display: none;
      position: fixed;
      z-index: 9999;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.9);
      justify-content: center;
      align-items: center;
    }
    .modal img {
      max-width: 100%;
      max-height: 100%;
    }
    .modal video {
      max-width: 100%;
      max-height: 100%;
}
  </style>
</head>
<body>
  <div class="container">

  <div class="container">
<div class="thumbnail" onclick="showImage('img/1.jpg')">
  <img src="img/1.jpg" alt="1">
</div>

<div class="thumbnail" onclick="showImage('img/2.jpg')">
  <img src="img/2.jpg" alt="2">
</div>

<div class="thumbnail" onclick="showImage('img/3.jpg')">
  <img src="img/3.jpg" alt="3">
</div>

<div class="thumbnail" onclick="showImage('img/4.jpg')">
  <img src="img/4.jpg" alt="4">
</div>

<div class="thumbnail" onclick="showImage('img/5.jpg')">
  <img src="img/5.jpg" alt="5">
</div>

<div class="thumbnail" onclick="showImage('img/6.jpg')">
  <img src="img/6.jpg" alt="6">
</div>

<div class="thumbnail" onclick="showImage('img/7.jpg')">
  <img src="img/7.jpg" alt="7">
</div>

<div class="thumbnail" onclick="showImage('img/8.jpg')">
  <img src="img/8.jpg" alt="8">
</div>

<div class="thumbnail" onclick="showImage('img/9.jpg')">
  <img src="img/9.jpg" alt="9">
</div>

<div class="thumbnail" onclick="showImage('img/10.jpg')">
  <img src="img/10.jpg" alt="10">
</div>

<div class="thumbnail" onclick="showImage('img/11.jpg')">
  <img src="img/11.jpg" alt="11">
</div>

<div class="thumbnail" onclick="showImage('img/12.jpg')">
  <img src="img/12.jpg" alt="12">
</div>

<div class="thumbnail" onclick="showImage('img/13.jpg')">
  <img src="img/13.jpg" alt="13">
</div>

<div class="thumbnail" onclick="showImage('img/14.jpg')">
  <img src="img/14.jpg" alt="14">
</div>

<div class="thumbnail" onclick="showImage('img/15.jpg')">
  <img src="img/15.jpg" alt="15">
</div>

<div class="thumbnail" onclick="showImage('img/16.jpg')">
  <img src="img/16.jpg" alt="16">
</div>

<div class="thumbnail" onclick="showImage('img/17.jpg')">
  <img src="img/17.jpg" alt="17">
</div>

<div class="thumbnail" onclick="showImage('img/18.jpg')">
  <img src="img/18.jpg" alt="18">
</div>

<div class="thumbnail" onclick="showImage('img/19.jpg')">
  <img src="img/19.jpg" alt="19">
</div>

<div class="thumbnail" onclick="showImage('img/20.jpg')">
  <img src="img/20.jpg" alt="20">
</div>

<div class="thumbnail" onclick="showImage('img/21.jpg')">
  <img src="img/21.jpg" alt="21">
</div>

<div class="thumbnail" onclick="showImage('img/22.jpg')">
  <img src="img/22.jpg" alt="22">
</div>

<div class="thumbnail" onclick="showImage('img/23.jpg')">
  <img src="img/23.jpg" alt="23">
</div>

<div class="thumbnail" onclick="showImage('img/24.jpg')">
  <img src="img/24.jpg" alt="24">
</div>

<div class="thumbnail" onclick="showImage('img/25.jpg')">
  <img src="img/25.jpg" alt="25">
</div>

<div class="thumbnail" onclick="showImage('img/26.jpg')">
  <img src="img/26.jpg" alt="26">
</div>

<div class="thumbnail" onclick="showImage('img/27.jpg')">
  <img src="img/27.jpg" alt="27">
</div>

<div class="thumbnail" onclick="showImage('img/28.jpg')">
  <img src="img/28.jpg" alt="28">
</div>

<div class="thumbnail" onclick="showImage('img/29.jpg')">
  <img src="img/29.jpg" alt="29">
</div>

<div class="thumbnail" onclick="showImage('img/30.jpg')">
  <img src="img/30.jpg" alt="30">
</div>

<div class="thumbnail" onclick="showImage('img/31.jpg')">
  <img src="img/31.jpg" alt="31">
</div>

<div class="thumbnail" onclick="showImage('img/32.jpg')">
  <img src="img/32.jpg" alt="32">
</div>

<div class="thumbnail" onclick="showImage('img/33.jpg')">
  <img src="img/33.jpg" alt="33">
</div>

<div class="thumbnail" onclick="showImage('img/34.jpg')">
  <img src="img/34.jpg" alt="34">
</div>

<div class="thumbnail" onclick="showImage('img/35.jpg')">
  <img src="img/35.jpg" alt="35">
</div>

<div class="thumbnail" onclick="showImage('img/36.jpg')">
  <img src="img/36.jpg" alt="36">
</div>

<div class="thumbnail" onclick="showImage('img/37.jpg')">
  <img src="img/37.jpg" alt="37">
</div>

<div class="thumbnail" onclick="showImage('img/38.jpg')">
  <img src="img/38.jpg" alt="38">
</div>

<div class="thumbnail" onclick="showImage('img/39.jpg')">
  <img src="img/39.jpg" alt="39">
</div>

<div class="thumbnail" onclick="showImage('img/40.jpg')">
  <img src="img/40.jpg" alt="40">
</div>

<div class="thumbnail" onclick="showImage('img/41.jpg')">
  <img src="img/41.jpg" alt="41">
</div>

<div class="thumbnail" onclick="showImage('img/42.jpg')">
  <img src="img/42.jpg" alt="42">
</div>

<div class="thumbnail" onclick="showImage('img/43.jpg')">
  <img src="img/43.jpg" alt="43">
</div>

<div class="thumbnail" onclick="showImage('img/44.jpg')">
  <img src="img/44.jpg" alt="44">
</div>

<div class="thumbnail" onclick="showImage('img/45.jpg')">
  <img src="img/45.jpg" alt="45">
</div>

<div class="thumbnail" onclick="showImage('img/46.jpg')">
  <img src="img/46.jpg" alt="46">
</div>

<div class="thumbnail" onclick="showImage('img/47.jpg')">
  <img src="img/47.jpg" alt="47">
</div>

<div class="thumbnail" onclick="showImage('img/48.jpg')">
  <img src="img/48.jpg" alt="48">
</div>

<div class="thumbnail" onclick="showImage('img/49.jpg')">
  <img src="img/49.jpg" alt="49">
</div>

<div class="thumbnail" onclick="showImage('img/50.jpg')">
  <img src="img/50.jpg" alt="50">
</div>

<div class="thumbnail" onclick="showImage('img/51.jpg')">
  <img src="img/51.jpg" alt="51">
</div>

<div class="thumbnail" onclick="showImage('img/52.jpg')">
  <img src="img/52.jpg" alt="52">
</div>

<div class="thumbnail" onclick="showImage('img/53.jpg')">
  <img src="img/53.jpg" alt="53">
</div>

<div class="thumbnail" onclick="showImage('img/54.jpg')">
  <img src="img/54.jpg" alt="54">
</div>

<div class="thumbnail" onclick="showImage('img/55.jpg')">
  <img src="img/55.jpg" alt="55">
</div>

<div class="thumbnail" onclick="showImage('img/56.jpg')">
  <img src="img/56.jpg" alt="56">
</div>

<div class="thumbnail" onclick="showImage('img/57.jpg')">
  <img src="img/57.jpg" alt="57">
</div>

<div class="thumbnail" onclick="showImage('img/58.jpg')">
  <img src="img/58.jpg" alt="58">
</div>

<div class="thumbnail" onclick="showImage('img/59.jpg')">
  <img src="img/59.jpg" alt="59">
</div>

<div class="thumbnail" onclick="showImage('img/60.jpg')">
  <img src="img/60.jpg" alt="60">
</div>

<div class="thumbnail" onclick="showImage('img/61.jpg')">
  <img src="img/61.jpg" alt="61">
</div>

<div class="thumbnail" onclick="showImage('img/62.jpg')">
  <img src="img/62.jpg" alt="62">
</div>

<div class="thumbnail" onclick="showImage('img/63.jpg')">
  <img src="img/63.jpg" alt="63">
</div>

<div class="thumbnail" onclick="showImage('img/64.jpg')">
  <img src="img/64.jpg" alt="64">
</div>

<div class="thumbnail" onclick="showImage('img/65.jpg')">
  <img src="img/65.jpg" alt="65">
</div>

<div class="thumbnail" onclick="showImage('img/66.jpg')">
  <img src="img/66.jpg" alt="66">
</div>

<div class="thumbnail" onclick="showImage('img/67.jpg')">
  <img src="img/67.jpg" alt="67">
</div>

<div class="thumbnail" onclick="showImage('img/68.jpg')">
  <img src="img/68.jpg" alt="68">
</div>

<div class="thumbnail" onclick="showImage('img/69.jpg')">
  <img src="img/69.jpg" alt="69">
</div>

<div class="thumbnail" onclick="showImage('img/70.jpg')">
  <img src="img/70.jpg" alt="70">
</div>

<div class="thumbnail" onclick="showImage('img/71.jpg')">
  <img src="img/71.jpg" alt="71">
</div>

<div class="thumbnail" onclick="showImage('img/72.jpg')">
  <img src="img/72.jpg" alt="72">
</div>

<div class="thumbnail" onclick="showImage('img/73.jpg')">
  <img src="img/73.jpg" alt="73">
</div>

<div class="thumbnail" onclick="showImage('img/74.jpg')">
  <img src="img/74.jpg" alt="74">
</div>

<div class="thumbnail" onclick="showImage('img/75.jpg')">
  <img src="img/75.jpg" alt="75">
</div>

<div class="thumbnail" onclick="showImage('img/76.jpg')">
  <img src="img/76.jpg" alt="76">
</div>

<div class="thumbnail" onclick="showImage('img/77.jpg')">
  <img src="img/77.jpg" alt="77">
</div>

<div class="thumbnail" onclick="showImage('img/78.jpg')">
  <img src="img/78.jpg" alt="78">
</div>

<div class="thumbnail" onclick="showImage('img/79.jpg')">
  <img src="img/79.jpg" alt="79">
</div>

<div class="thumbnail" onclick="showImage('img/80.jpg')">
  <img src="img/80.jpg" alt="80">
</div>

<div class="thumbnail" onclick="showImage('img/81.jpg')">
  <img src="img/81.jpg" alt="81">
</div>

<div class="thumbnail" onclick="showImage('img/82.jpg')">
  <img src="img/82.jpg" alt="82">
</div>

<div class="thumbnail" onclick="showImage('img/83.jpg')">
  <img src="img/83.jpg" alt="83">
</div>

<div class="thumbnail" onclick="showImage('img/84.jpg')">
  <img src="img/84.jpg" alt="84">
</div>

<div class="thumbnail" onclick="showImage('img/85.jpg')">
  <img src="img/85.jpg" alt="85">
</div>

<div class="thumbnail" onclick="showImage('img/86.jpg')">
  <img src="img/86.jpg" alt="86">
</div>

<div class="thumbnail" onclick="showImage('img/87.jpg')">
  <img src="img/87.jpg" alt="87">
</div>

<div class="thumbnail" onclick="showImage('img/88.jpg')">
  <img src="img/88.jpg" alt="88">
</div>

<div class="thumbnail" onclick="showImage('img/89.jpg')">
  <img src="img/89.jpg" alt="89">
</div>

<div class="thumbnail" onclick="showImage('img/90.jpg')">
  <img src="img/90.jpg" alt="90">
</div>

<div class="thumbnail" onclick="showImage('img/91.jpg')">
  <img src="img/91.jpg" alt="91">
</div>

<div class="thumbnail" onclick="showImage('img/92.jpg')">
  <img src="img/92.jpg" alt="92">
</div>

<div class="thumbnail" onclick="showImage('img/93.jpg')">
  <img src="img/93.jpg" alt="93">
</div>

<div class="thumbnail" onclick="showImage('img/94.jpg')">
  <img src="img/94.jpg" alt="94">
</div>

<div class="thumbnail" onclick="showImage('img/95.jpg')">
  <img src="img/95.jpg" alt="95">
</div>

<div class="thumbnail" onclick="showImage('img/96.jpg')">
  <img src="img/96.jpg" alt="96">
</div>

<div class="thumbnail" onclick="showImage('img/97.jpg')">
  <img src="img/97.jpg" alt="97">
</div>

<div class="thumbnail" onclick="showImage('img/98.jpg')">
  <img src="img/98.jpg" alt="98">
</div>

<div class="thumbnail" onclick="showImage('img/99.jpg')">
  <img src="img/99.jpg" alt="99">
</div>

<div class="thumbnail" onclick="showImage('img/100.jpg')">
  <img src="img/100.jpg" alt="100">
</div>

  <!-- テンプレート -->
  <!--
<div class="thumbnail" onclick="showImage('img/〇.jpg')">
  <img src="img/〇.jpg">
     <div class="caption">「」</div>
</div>

<div class="thumbnail" onclick="showImage('img/〇.jpg')">
  <img src="img/〇.jpg">
</div>

<div class="video-thumbnail" onclick="showVideo('img/〇.mp4')">
  <video src="img/〇.mp4" controls loop>
  </video>
</div>
  -->

  </div>

<!-- モーダルウィンドウ -->
<div class="modal" id="modalViewer" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; justify-content: center; align-items: center; background-color: rgba(0, 0, 0, 0.8);">
  <span onclick="closeModal()" style="position: absolute; top: 10px; right: 10px; color: #fff; cursor: pointer; font-size: 20px;">×</span>
  <img id="modalImage" src="" alt="Image" style="max-width: 100%; max-height: 100%; display: none;">
  <video id="modalVideo" controls style="max-width: 100%; max-height: 100%; display: none;"></video>
</div>

<script>
// ギャラリーの初期化を行う関数
function initializeGallery() {
    thumbnails = Array.from(document.querySelectorAll('.thumbnail img, .video-thumbnail video'));
    console.log(`Total media items: ${thumbnails.length}`);

    thumbnails.forEach((thumbnail, index) => {
        thumbnail.addEventListener('click', () => {
            if (thumbnail.tagName.toLowerCase() === 'img') {
                showImage(index);
            } else {
                showVideo(index);
            }
        });
    });
}

// 指定された画像をモーダルで表示する関数
function showImage(index) {
    if (index < 0 || index >= thumbnails.length) return;

    const modalImage = document.getElementById('modalImage');
    const modalVideo = document.getElementById('modalVideo');

    modalVideo.style.display = 'none';
    modalVideo.loop = true; // 動画をループ再生する
    modalImage.style.display = 'block';
    modalImage.src = thumbnails[index].src;

    currentIndex = index;
    document.getElementById('modalViewer').style.display = 'flex';
    document.addEventListener('keydown', handleKeyPress);
    modalImage.addEventListener('touchstart', handleTouchStart);
    modalImage.addEventListener('touchend', handleTouchEnd);
}

// 指定された動画をモーダルで表示する関数
function showVideo(index) {
    if (index < 0 || index >= thumbnails.length) return;

    const modalImage = document.getElementById('modalImage');
    const modalVideo = document.getElementById('modalVideo');

    modalImage.style.display = 'none';
    modalVideo.style.display = 'block';
    modalVideo.src = thumbnails[index].src;

    currentIndex = index;
    document.getElementById('modalViewer').style.display = 'flex';
    modalVideo.play();

    document.addEventListener('keydown', handleKeyPress);
    modalVideo.addEventListener('touchstart', handleTouchStart);
    modalVideo.addEventListener('touchend', handleTouchEnd);
}

// 画像または動画を前後に切り替える関数
function changeImage(direction) {
    if (direction === 'prev') {
        currentIndex = (currentIndex - 1 + thumbnails.length) % thumbnails.length;
    } else if (direction === 'next') {
        currentIndex = (currentIndex + 1) % thumbnails.length;
    }

    const currentThumbnail = thumbnails[currentIndex];
    const modalImage = document.getElementById('modalImage');
    const modalVideo = document.getElementById('modalVideo');

    if (currentThumbnail.tagName.toLowerCase() === 'img') {
        modalVideo.style.display = 'none';
        modalVideo.pause();
        modalImage.style.display = 'block';
        modalImage.src = currentThumbnail.src;
    } else {
        modalImage.style.display = 'none';
        modalVideo.style.display = 'block';
        modalVideo.src = currentThumbnail.src;
        modalVideo.play();
    }
}

// 前の画像に切り替えるための関数
function prevImage() {
    changeImage('prev');
}

// 次の画像に切り替えるための関数
function nextImage() {
    changeImage('next');
}

// モーダルを閉じる関数
function closeModal() {
    document.getElementById('modalViewer').style.display = 'none';
    document.removeEventListener('keydown', handleKeyPress);

    const modalImage = document.getElementById('modalImage');
    modalImage.removeEventListener('touchstart', handleTouchStart);
    modalImage.removeEventListener('touchend', handleTouchEnd);
    modalImage.src = '';

    const modalVideo = document.getElementById('modalVideo');
    modalVideo.pause();
    modalVideo.src = '';
}

// キーボードの操作を処理する関数
function handleKeyPress(event) {
    if (event.key === 'ArrowLeft') {
        prevImage();
    } else if (event.key === 'ArrowRight') {
        nextImage();
    } else if (event.key === 'Escape') {
        closeModal();
    }
}

// タッチ操作の開始位置を記録する変数
let touchStartX;
let touchEndX;
let touchStartTimeout;

// タッチ操作の開始時に呼ばれる関数
function handleTouchStart(event) {
    touchStartX = event.changedTouches[0].screenX;
    touchStartTimeout = setTimeout(() => {
        openImageInNewTab();
    }, 500);
}

// タッチ操作の終了時に呼ばれる関数
function handleTouchEnd(event) {
    clearTimeout(touchStartTimeout);
    touchEndX = event.changedTouches[0].screenX;

    if (touchEndX < touchStartX) {
        nextImage();
    } else if (touchEndX > touchStartX) {
        prevImage();
    }

    touchStartX = 0;
    touchEndX = 0;
}

// モーダル内の画像を新しいタブで開く関数
function openImageInNewTab() {
    window.open(document.getElementById('modalImage').src, '_blank');
}

document.addEventListener('DOMContentLoaded', initializeGallery);
</script>
</body>
</html>
    </textarea>

    <script>
        document.getElementById('downloadBtn').addEventListener('click', function() {
            var content = document.getElementById('htmlContent').value;
            var blob = new Blob([content], {type: 'text/html'});
            var url = URL.createObjectURL(blob);
            var a = document.createElement('a');
            a.href = url;
            a.download = 'template.html';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        });
    </script>
</body>
</html>